# test stuff that has broken

# ; after a FOR clause
SELECT * FROM $planets FOR '2022-01-09'
SELECT * FROM $planets FOR '2022-01-09';
SELECT * FROM $planets FOR '2022-01-09'; --
SELECT * FROM $planets FOR TODAY
SELECT * FROM $planets FOR TODAY;
SELECT * FROM $planets FOR TODAY; --
SELECT * FROM $planets FOR DATES BETWEEN YESTERDAY AND TODAY
SELECT * FROM $planets FOR DATES BETWEEN YESTERDAY AND TODAY;
SELECT * FROM $planets FOR DATES BETWEEN YESTERDAY AND TODAY; --
SELECT * FROM $planets FOR DATES BETWEEN '2000-01-01' AND '2022-01-01'
SELECT * FROM $planets FOR DATES BETWEEN '2000-01-01' AND '2022-01-01';
SELECT * FROM $planets FOR DATES BETWEEN '2000-01-01' AND '2022-01-01'; --

# second condition empty failures
SELECT * FROM $planets WHERE TRUE AND FALSE;
SELECT * FROM $planets WHERE FALSE AND TRUE;
SELECT * FROM $planets WHERE TRUE OR FALSE;
SELECT * FROM $planets WHERE FALSE OR TRUE;

# [#561] HASH JOIN with an empty table
SELECT * FROM $planets LEFT JOIN (SELECT planetId as id FROM $satellites WHERE id < 0) USING (id);

# zero record queries
SELECT name, COUNT(*) FROM $astronauts WHERE name = 'Jim' GROUP BY name;
SELECT * FROM testdata.nulls FOR '2000-01-01' WHERE tweet ILIKE '%Trump%';
SELECT * FROM $planets WHERE id = -1 LIMIT 10;
SELECT * FROM $planets WHERE id = -1 ORDER BY id;
SELECT * FROM $planets WHERE id = -1;
SELECT * FROM $satellites WHERE id = 5 AND magnitude = 1;
SELECT * FROM $satellites WHERE name = '********';

# aggregate on literals
SELECT COUNT(1) FROM $satellites;
SELECT SUM(42) FROM $planets;

# [#592] 
SELECT birth_date - TODAY() FROM $astronauts;
SELECT birth_date - NOW() FROM $astronauts
SELECT birth_date - current_time FROM $astronauts;
SELECT birth_date - current_date FROM $astronauts;
SELECT DATE(birth_date) - TODAY() FROM $astronauts;
SELECT DATE(birth_date) - NOW() FROM $astronauts
SELECT DATE(birth_date) - current_time FROM $astronauts;
SELECT DATE(birth_date) - current_date FROM $astronauts;

SELECT TIMESTAMP(birth_date) - TODAY() FROM $astronauts;
SELECT DATEDIFF('days', birth_date, TODAY()) FROM $astronauts;

# [TEMPORAL FILTER EXTRACTION PROBLEMS]
SET @planet = 'Saturn'; SELECT name AS nom, bigsats.occurances, smallsats.occurances FROM (SELECT DISTINCT id as planetId, name FROM $planets WHERE name = @planet) as planets LEFT JOIN (SELECT planetId, COUNT(*) AS occurances FROM $satellites FOR DATES BETWEEN '2022-01-01' AND TODAY WHERE gm > 10 GROUP BY planetId) AS bigsats ON bigsats.planetId = planets.planetId LEFT JOIN (SELECT planetId, COUNT(*) AS occurances FROM $satellites FOR DATES IN LAST_MONTH WHERE gm < 10 GROUP BY planetId) as smallsats ON smallsats.planetId = planets.planetId ; 
SELECT 1 WHERE ' a  b ' = ' ' || 'a' || ' ' || ' b '